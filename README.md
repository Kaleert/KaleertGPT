# Описание бота для Telegram

## 1. Описание проекта

Этот проект представляет собой Telegram-бота, который использует API OpenAI для предоставления пользователям возможности взаимодействия с языковыми моделями, генерации изображений и управления их профилями. Бот также включает веб-интерфейс, который позволяет пользователям регистрироваться и авторизовываться. Веб-сайт имеет простую страницу профиля, но функционал управления подписками пока не реализован. Длинные ответы от бота предоставляются в виде статей на сайте с соответствующими ссылками.

## 2. Функционал

•   Взаимодействие с языковыми моделями: Пользователи могут задавать вопросы и получать ответы от языковых моделей OpenAI.

•   Генерация изображений: Бот позволяет пользователям генерировать изображения на основе текстовых запросов.

•   Просмотр профилей: Пользователи могут просматривать и редактировать свои профили в телеграме и на сайте. На данный момент страница профиля на сайте является примитивной заглушкой.

•   Авторизация через Telegram: Пользователи могут входить в систему, используя свой Telegram-аккаунт в чат-боте, что упрощает процесс регистрации и аутентификации.

•   Административные функции: Администраторы могут управлять пользователями, банить и разбанивать их, а также просматривать статистику. Администраторы могут добавлять других пользователей в список администраторов и изменять их уровень доступа, а также изменять статистику пользователя.

•   Рассылка сообщений: Бот поддерживает отправку рассылок пользователям, что позволяет администратору информировать пользователей о важных событиях или обновлениях.

•   Веб-интерфейс: Бот включает веб-интерфейс. Пользователи могут заходить на сайт, где могут просматривать свои данные и длинные ответы от бота.

•   API провайдеры: Данные для API провайдеров необходимо найти самостоятельно и заполнить в конфигурации.

•   Ссылки в футере: Ссылки в футере нужно изменять на каждой странице вручную. Проект предназначен для ознакомления и изучения.


## 3. Команды
```
/start - Начать взаимодействие с ботом - Все пользователи
/stats - Показать статистику бота - Все пользователи
/stat - изменить статистику пользователя (баланс, рефералы) - Админ 4 уровня
/ban - Забанить пользователя - Админ 2 уровня
/unban - Разбанить пользователя - Админ 2 уровня
/clear - Очистить контекст пользователя - Админ 3 уровня
/admin - Управление администраторами (добавить, удалить, изменить уровень) - Админ 3 уровня
/profile - Показать свой профиль - Все пользователи
/profile show <id|@username> - Показать профиль другого пользователя - Админ 1 уровня
/ref - Показать реферальную ссылку - Все пользователи
/img - Запустить процесс генерации изображения - Все пользователи
/broadcast - Меню управления рассылками - Админ 4 уровня
```

## 4. Общие вопросы

•   Как работает бот? Бот использует API OpenAI для обработки запросов и генерации ответов. Пользователи могут взаимодействовать с ботом через Telegram.

•   Какой язык программирования используется? Бот написан на Python с использованием библиотек Flask, Aiogram и Pyrogram.

•   Как выдать админку? Чтобы выдать админские права, нужно добавить пользователя в таблицу `admins` в базе данных `bot_data.db`, указав его `user_id`, `username` и уровень доступа. Уровень доступа может быть от 1 до 5, где 5 (по факту - любой, больше 4) — это полный доступ.


## 5. Как установить

1.  Склонируйте репозиторий:
```bash
  git clone https://github.com/kaleert/KaleertGPT.git
  cd KaleertGPT
```

2. Установите зависимости:

  
```bash
  pip install -r requirements.txt
```

3. Настройте файл конфигурации `config.py` с необходимыми параметрами (например, токены и ключи API). Вот полный конфигурационный файл:

  
```python
  BOT_TOKEN = "" # токен бота (REQUIRED)
  API_ID = 12345 # (REQUIRED)
  API_HASH = "" # (REQUIRED)
  URL = "https://mydomain.com" # адрес сайта (REQUIRED)
  WEB_PORT = 12345 # OPTIONAL, default = 12345
  system_prompt = "ты универсальный помощник" # OPTIONAL
  ENGEENER_LOGS = False # OPTIONAL, default = False
  BOT_USERNAME = "USER_NAME_BOT" # (REQUIRED) юз бота в Telegram (без @)
  BOT_NAME = "Chat" # OPTIONAL
  SUBSCRIBE_REQUIRED = False # OPTIONAL, Default = False
  CHANNEL = "@channel" # OPTIONAL # бот должен быть админом канала
  CHECK_INTERVAL = 60 # интервал проверки подписки # OPTIONAL, default = 60

  ADMIN_LOGGING = True # OPTIONAL (False) Если True группа будет получать логи от бота
  BOT_LOGS_CHANNEL = -1001234567890 # OPTIONAL (REQUIRED if ADMIN_LOGGING = True)
  IS_SUPERGROUP = True # REQUIRED #(False) True если канал юзера является суппергруппой, False если канал юзера является обычной группой или каналом

  BAN_THREAD = 3
  UNBAN_THREAD = 5
  ACTION_THREAD = 9
  REGISTER_THREAD = 7

  API_PROVIDERS = {
    "provider1": {"base_url": "http://api.povider1.fun", "api_key": "sk-...", "models": ["gpt-4o-mini", "deepseek-v3"], "proxy": None},
    "provider2": {"base_url": "http://api.povider2.fun", "api_key": "sk-...", "models": ["gpt-4", "gpt-3.5-turbo", "gpt-4o", "gpt-4o-mini"], "proxy": "http://your_proxy_address:port"}
  }

  API_PROVIDERS_IMAGE = {
    "provider1": {"base_url": "http://api.povider1.fun", "api_key": "sk-...", "img_models": ["flux-dev", "flux-schnell", "sdxl-turbo", "poli"]},
    "provider2": {"base_url": "http://api.povider2.fun", "api_key": "sk-...", "img_models": ["flux"]}
  }

  RESOLUTIONS = {
    "1024x1024": (1024, 1024),
    "1024x576": (1024, 576),
    "1024x768": (1024, 768),
    "512x512": (512, 512),
    "576x1024": (576, 1024),
    "768x1024": (768, 1024)
  }
```

4. Запустите бота:

  
```bash
  python main.py
```

▌6. Что делать если вы обнаружили баг?

Если вы обнаружили баг, пожалуйста, напишите мне напрямую через GitHub или Telegram с описанием проблемы. Укажите шаги для воспроизведения, ожидаемое и фактическое поведение.

▌7. Контрибьюторы и идеи для развития

Контрибьютор: Kaleert. Если вы хотите внести свой вклад в проект, пожалуйста, создайте pull request с вашими изменениями. Мы также приветствуем идеи для улучшения функционала и добавления новых возможностей. Свяжитесь с нами через issues или pull requests!
